#! /bin/sh
. "${srcdir=.}/init.sh"; path_prepend_ . ../src

# Test 'quot' and 'boldquot' filter.

cat <<\EOF > mfi.po
msgid ""
msgstr ""
"Project-Id-Version: PACKAGE VERSION\n"
"PO-Revision-Date: 2014-04-10 16:40+0900\n"
"Last-Translator: FULL NAME <EMAIL@ADDRESS>\n"
"Language-Team: LANGUAGE <LL@li.org>\n"
"MIME-Version: 1.0\n"
"Content-Type: text/plain; charset=US-ASCII\n"
"Content-Transfer-Encoding: 8bit\n"

msgid "\"double quoted\""
msgstr "\"double quoted\""

msgid "\"\"double quoted\""
msgstr "\"\"double quoted\""

msgid "\"foo\" \"bar\" \"baz\""
msgstr "\"foo\" \"bar\" \"baz\""

msgid "double quoted but empty \"\""
msgstr "double quoted but empty \"\""

msgid "'single quoted'"
msgstr "'single quoted'"

msgid "'foo' 'bar' 'baz'"
msgstr "'foo' 'bar' 'baz'"

msgid "prefix'single quoted without surrounding spaces'suffix"
msgstr "prefix'single quoted without surrounding spaces'suffix"

msgid "prefix 'single quoted with surrounding spaces' suffix"
msgstr "prefix 'single quoted with surrounding spaces' suffix"

msgid "single quoted with apostrophe, empty '' "
msgstr "single quoted with apostrophe, empty '' "

msgid "'single quoted at the beginning of string' "
msgstr "'single quoted at the beginning of string' "

msgid " 'single quoted at the end of string'"
msgstr " 'single quoted at the end of string'"

msgid ""
"line 1\n"
"'single quoted at the beginning of line' \n"
"line 3"
msgstr ""
"line 1\n"
"'single quoted at the beginning of line' \n"
"line 3"

msgid ""
"line 1\n"
" 'single quoted at the end of line'\n"
"line 3"
msgstr ""
"line 1\n"
" 'single quoted at the end of line'\n"
"line 3"

msgid "`single quoted with grave'"
msgstr "`single quoted with grave'"

msgid "single quoted with grave, empty `'"
msgstr "single quoted with grave, empty `'"

msgid "``double grave'"
msgstr "``double grave'"
EOF

: ${MSGFILTER=msgfilter}
LC_ALL=C ${MSGFILTER} -i mfi.po -o mfi-quot.out quot 2>&1 2>/dev/null || Exit 1

cat <<\EOF > mfi-quot.ok
msgid ""
msgstr ""
"Project-Id-Version: PACKAGE VERSION\n"
"PO-Revision-Date: 2014-04-10 16:40+0900\n"
"Last-Translator: FULL NAME <EMAIL@ADDRESS>\n"
"Language-Team: LANGUAGE <LL@li.org>\n"
"MIME-Version: 1.0\n"
"Content-Type: text/plain; charset=UTF-8\n"
"Content-Transfer-Encoding: 8bit\n"

msgid "\"double quoted\""
msgstr "‚Äúdouble quoted‚Äù"

msgid "\"\"double quoted\""
msgstr "\"\"double quoted\""

msgid "\"foo\" \"bar\" \"baz\""
msgstr "‚Äúfoo‚Äù ‚Äúbar‚Äù ‚Äúbaz‚Äù"

msgid "double quoted but empty \"\""
msgstr "double quoted but empty \"\""

msgid "'single quoted'"
msgstr "'single quoted'"

msgid "'foo' 'bar' 'baz'"
msgstr "‚Äòfoo‚Äô ‚Äòbar‚Äô ‚Äòbaz‚Äô"

msgid "prefix'single quoted without surrounding spaces'suffix"
msgstr "prefix'single quoted without surrounding spaces'suffix"

msgid "prefix 'single quoted with surrounding spaces' suffix"
msgstr "prefix ‚Äòsingle quoted with surrounding spaces‚Äô suffix"

msgid "single quoted with apostrophe, empty '' "
msgstr "single quoted with apostrophe, empty ‚Äò‚Äô "

msgid "'single quoted at the beginning of string' "
msgstr "‚Äòsingle quoted at the beginning of string‚Äô "

msgid " 'single quoted at the end of string'"
msgstr " ‚Äòsingle quoted at the end of string‚Äô"

msgid ""
"line 1\n"
"'single quoted at the beginning of line' \n"
"line 3"
msgstr ""
"line 1\n"
"‚Äòsingle quoted at the beginning of line‚Äô \n"
"line 3"

msgid ""
"line 1\n"
" 'single quoted at the end of line'\n"
"line 3"
msgstr ""
"line 1\n"
" ‚Äòsingle quoted at the end of line‚Äô\n"
"line 3"

msgid "`single quoted with grave'"
msgstr "‚Äòsingle quoted with grave‚Äô"

msgid "single quoted with grave, empty `'"
msgstr "single quoted with grave, empty ‚Äò‚Äô"

msgid "``double grave'"
msgstr "`‚Äòdouble grave‚Äô"
EOF

: ${DIFF=diff}
${DIFF} mfi-quot.ok mfi-quot.out || Exit 1

LC_ALL=C ${MSGFILTER} -i mfi.po -o mfi-boldquot.out boldquot 2>&1 2>/dev/null || Exit 1

cat <<\EOF > mfi-boldquot.ok
msgid ""
msgstr ""
"Project-Id-Version: PACKAGE VERSION\n"
"PO-Revision-Date: 2014-04-10 16:40+0900\n"
"Last-Translator: FULL NAME <EMAIL@ADDRESS>\n"
"Language-Team: LANGUAGE <LL@li.org>\n"
"MIME-Version: 1.0\n"
"Content-Type: text/plain; charset=UTF-8\n"
"Content-Transfer-Encoding: 8bit\n"

msgid "\"double quoted\""
msgstr "‚Äú[1mdouble quoted[0m‚Äù"

msgid "\"\"double quoted\""
msgstr "\"\"double quoted\""

msgid "\"foo\" \"bar\" \"baz\""
msgstr "‚Äú[1mfoo[0m‚Äù ‚Äú[1mbar[0m‚Äù ‚Äú[1mbaz[0m‚Äù"

msgid "double quoted but empty \"\""
msgstr "double quoted but empty \"\""

msgid "'single quoted'"
msgstr "'single quoted'"

msgid "'foo' 'bar' 'baz'"
msgstr "‚Äò[1mfoo[0m‚Äô ‚Äò[1mbar[0m‚Äô ‚Äò[1mbaz[0m‚Äô"

msgid "prefix'single quoted without surrounding spaces'suffix"
msgstr "prefix'single quoted without surrounding spaces'suffix"

msgid "prefix 'single quoted with surrounding spaces' suffix"
msgstr "prefix ‚Äò[1msingle quoted with surrounding spaces[0m‚Äô suffix"

msgid "single quoted with apostrophe, empty '' "
msgstr "single quoted with apostrophe, empty ‚Äò[1m[0m‚Äô "

msgid "'single quoted at the beginning of string' "
msgstr "‚Äò[1msingle quoted at the beginning of string[0m‚Äô "

msgid " 'single quoted at the end of string'"
msgstr " ‚Äò[1msingle quoted at the end of string[0m‚Äô"

msgid ""
"line 1\n"
"'single quoted at the beginning of line' \n"
"line 3"
msgstr ""
"line 1\n"
"‚Äò[1msingle quoted at the beginning of line[0m‚Äô \n"
"line 3"

msgid ""
"line 1\n"
" 'single quoted at the end of line'\n"
"line 3"
msgstr ""
"line 1\n"
" ‚Äò[1msingle quoted at the end of line[0m‚Äô\n"
"line 3"

msgid "`single quoted with grave'"
msgstr "‚Äò[1msingle quoted with grave[0m‚Äô"

msgid "single quoted with grave, empty `'"
msgstr "single quoted with grave, empty ‚Äò[1m[0m‚Äô"

msgid "``double grave'"
msgstr "`‚Äò[1mdouble grave[0m‚Äô"
EOF

${DIFF} mfi-boldquot.ok mfi-boldquot.out || Exit 1
